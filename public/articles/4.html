<h1 class="article-title">FastAPI. –û—Å–Ω–æ–≤—ã</h1>
<div class="article-meta">
    <span>üóì 28 –ê–ø—Ä–µ–ª—è 2025</span>
    <span>üè∑Ô∏è FastAPI, Python</span>
</div>
<p>FastAPI –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –±—ã—Å—Ç—Ä—ã–π –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –Ω–∞ —è–∑—ã–∫–µ Python.</p>
<p>–í —Ü–µ–Ω—Ç—Ä–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è FastAPI –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –æ–¥–Ω–æ–∏–º–µ–Ω–Ω—ã–π –∫–ª–∞—Å—Å FastAPI –∏–∑ –ø–∞–∫–µ—Ç–∞ fastapi. –î–∞–Ω–Ω—ã–π –∫–ª–∞—Å—Å —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ FastAPI. –≠—Ç–æ—Ç –∫–ª–∞—Å—Å –Ω–∞—Å–ª–µ–¥—É–µ—Ç—Å—è –æ—Ç –∫–ª–∞—Å—Å–∞ starlette.applications.Starlette.<br>Starlette –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –¥—Ä—É–≥–æ–π –ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã–π ASGI-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –≤–µ–±-—Å–µ—Ä–≤–∏—Å–æ–≤ –Ω–∞ Python. –°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ, FastAPI —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–≤–µ—Ä—Ö Scarlette, –∏—Å–ø–æ–ª—å–∑—É—è –∏ –¥–æ–ø–æ–ª–Ω—è—è –µ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å. –≠—Ç–æ –∫–∞—Å–∞–µ—Ç—Å—è –Ω–µ —Ç–æ–ª—å–∫–æ —Å–∞–º–æ–≥–æ –∫–ª–∞—Å—Å–∞ FastAPI, –Ω–æ –∏ –¥—Ä—É–≥–∏—Ö –∫–ª–∞—Å—Å–æ–≤ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞ - –º–Ω–æ–≥–∏–µ –∏–∑ –Ω–∏—Ö –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª Scarlette.</p>
<h3 class="section-title" id="proc_req_resps">–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤</h3>
<p>–í –∫–ª–∞—Å—Å–µ FastAPI –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑ —Ç–∏–ø–æ–≤ REST –∑–∞–ø—Ä–æ—Å–æ–≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –æ–¥–Ω–æ–∏–º–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã: get, post, put, delete, options, head, patch, trace</p>
<pre><code class="lang-py">from fastapi import FastAPI
from fastapi.responses import Response, HTMLResponse, JSONResponse,  PlainTextResponse, FileResponse
from fastapi.encoders import jsonable_encoder

app = FastAPI()

# –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–µ - HTMLResponse, JSONResponse,  PlainTextResponse, FileResponse

@app.get("/")
def root():
    # –ö–ª–∞—Å—Å fastapi.Response —è–≤–ª—è–µ—Ç—Å—è –±–∞–∑–æ–≤—ã–º –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤ –æ—Ç–≤–µ—Ç–∞.
    return Response(content="<h1>=== Hello FastAPI! main page ===</h1>", media_type="text/html")

# –î–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–∞–π–ª–æ–≤ –∏–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è FastAPI –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–ª–∞—Å—Å FileResponse
@app.get("/file", response_class=FileResponse)
def about():
    # –ü—É—Å—Ç—å –≤ –ø—Ä–æ–µ–∫—Ç–µ –≤ –ø–∞–ø–∫–µ public –µ—Å—Ç—å —Ñ–∞–π–ª index.html
    return FileResponse(path="public/index.html")
    # –ú–æ–∂–µ—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∑–∏—Ç—å –±–µ–∑ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∞–∫–∏–µ-–Ω–∏–±—É–¥—å –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º—ã–µ
    # —Ñ–∞–π–ª—ã - –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ –º—ã –º–æ–∂–µ–º —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ media_type –∑–Ω–∞—á–µ–Ω–∏–µ application/octet-stream
    # return FileResponse(
    #   "public/index.html", 
    #   filename="mainpage.html", 
    #   media_type="application/octet-stream"
    # )</code></pre>
<h3 class="section-title" id="path_params">–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—É—Ç–∏ –∏ —Å—Ç—Ä–æ–∫–∏ –∑–∞–ø—Ä–æ—Å–∞</h3>
<p>–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—É—Ç–∏ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –≤ —à–∞–±–ª–æ–Ω–µ –ø—É—Ç–∏ –≤–Ω—É—Ç—Ä–∏ —Ñ–∏–≥—É—Ä–Ω—ã—Ö —Å–∫–æ–±–æ–∫: {–Ω–∞–∑–≤–∞–Ω–∏–µ_–ø–∞—Ä–∞–º–µ—Ç—Ä–∞}.</p>
<pre><code class="lang-py">@app.get("/users/{id}")
def users(id):
    return {"user_id": id}

@app.get("/users/{fname}/{lname}")
def users2(fname, lname):
    return {"fname": fname, "lname": lname}

@app.get("/users/{fname}-{lname}")  # users/Alice-Johnson
def users3(fname, lname):
    return {"fname": fname, "lname": lname}</code></pre>
<p>–û–¥–Ω–∞–∫–æ –ø—Ä–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ —à–∞–±–ª–æ–Ω–æ–≤ –ø—É—Ç–µ–π —Å–ª–µ–¥—É–µ—Ç —É—á–∏—Ç—ã–≤–∞—Ç—å, —á—Ç–æ –º–µ–∂–¥—É —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —à–∞–±–ª–æ–Ω–∞–º–∏ –º–æ–∂–µ—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å –¥–≤–æ–π—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å, –∫–æ–≥–¥–∞ –∑–∞–ø—Ä–æ—Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º —à–∞–±–ª–æ–Ω–∞–º. –ò –≤ —ç—Ç–æ–π —Å–≤—è–∑–∏ —Å–ª–µ–¥—É–µ—Ç —É—á–∏—Ç—ã–≤–∞—Ç—å –æ—á–µ—Ä–µ–¥–Ω–æ—Å—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —à–∞–±–ª–æ–Ω–æ–≤ –ø—É—Ç–µ–π:</p>
<pre><code class="lang-py"># –°–Ω–∞—á–∞–ª–∞ —ç—Ç–æ—Ç –º–µ—Ç–æ–¥
@app.get("/users/admin")
def admin():
    return {"message": "Hello admin"}

# –¢–æ–ª—å–∫–æ –ø–æ—Ç–æ–º —ç—Ç–æ—Ç
@app.get("/users/{name}")
def users(name):
    return {"user_name": name}</code></pre>
<p>FastAPI –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å —Ç–∏–ø –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –Ω–∞–±–æ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π</p>
<pre><code class="lang-py">@app.get("/users/{id}")
def users(id: int):
    return {"user_id": id}</code></pre>
<p>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –ø—É—Ç–∏ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ FastAPI –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∫–ª–∞—Å—Å Path –∏–∑ –ø–∞–∫–µ—Ç–∞ fastapi. –û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:</p>
<pre><code class="lang-py">from fastapi import Path

# –†–∞—Å–ø—Ä–æ—Å—Ç–∞–Ω–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: min_length, max_length, pattern, lt, le, gt, ge

@app.get("/users/{name}/{age}")
def users(
    name: str = Path(min_length=3, max_length=20), 
    age: int = Path(ge=18, lt=111),
):
    return {"name": name, "age": age}</code></pre>
<p>–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Ç—Ä–æ–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç –µ—â–µ –æ–¥–∏–Ω —Å–ø–æ—Å–æ–± –ø–µ—Ä–µ–¥–∞—Ç—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∑–∞–ø—Ä–æ—Å–µ —Ç–∏–ø–∞ GET. </p>
<pre><code class="lang-py">@app.get("/users")
# GET users/?param1=qwe&#38;param2=asd - –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã, –µ—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞—Ç—å - –æ—à–∏–±–∫–∞
def get_model(param1, param2):
    return {"param1": param1, "param2": param2}</code></pre>
<p>–í–ø–æ–ª–Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å, —á—Ç–æ –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é –Ω–µ –ø–µ—Ä–µ–¥–∞—é—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –∫–∞–∫–æ–≥–æ-–ª–∏–±–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ (–∏–ª–∏ –≤—Å–µ—Ö). –í –ø—Ä–∏–º–µ—Ä–µ –≤—ã—à–µ –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Ç—Ä–æ–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ —è–≤–ª—è—é—Ç—Å—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏. –ò –µ—Å–ª–∏ –º—ã –Ω–µ –ø–µ—Ä–µ–¥–∞–¥–∏–º —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –∏–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, —Ç–æ –º—ã –ø–æ–ª—É—á–∏–º –æ—à–∏–±–∫—É. –ß—Ç–æ–±—ã –æ—à–∏–±–∫–∏ –Ω–µ –±—ã–ª–æ, –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.</p>
<pre><code class="lang-py">app.get("/users")
def get_model(param1 = None, param2 = None):
    return {"param1": param1, "param2": param2}</code></pre>
<p>–¢–∞–∫–∂–µ –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å—Ç—Ä–æ–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ —Ç–∏–ø—É</p>
<pre><code class="lang-py">app.get("/users")
def get_model(param1: str = 'empty', param2: int = 0):
    # –ï—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—É –ø–µ—Ä–µ–¥–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –¥—Ä—É–≥–æ–≥–æ —Ç–∏–ø–∞ - –ø–æ–ª—É—á–∏–º –æ—à–∏–±–∫—É.
    return {"param1": param1, "param2": param2}</code></pre>
<p>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ —Å—Ç—Ä–æ–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ FastAPI –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∫–ª–∞—Å—Å Query –∏–∑ –ø–∞–∫–µ—Ç–∞ fastapi. –ö–ª–∞—Å—Å Query –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–µ–∂–¥–µ –≤—Å–µ–≥–æ –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å—Ç—Ä–æ–∫–∏ –∑–∞–ø—Ä–æ—Å–∞.</p>
<pre><code class="lang-py">from fastapi import Query

# min_length: —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º–≤–æ–ª–æ–≤ –≤ –∑–Ω–∞—á–µ–Ω–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
# max_length: —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º–≤–æ–ª–æ–≤ –≤ –∑–Ω–∞—á–µ–Ω–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
# pattern: —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–º—É –¥–æ–ª–∂–Ω–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
# lt: –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –º–µ–Ω—å—à–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
# le: –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –º–µ–Ω—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é
# gt: –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –±–æ–ª—å—à–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
# ge: –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –±–æ–ª—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é
@app.get("/users")
def users(
    name: str = Query(default='empty', min_length=3, max_length=20),
    age: int = Query(default=None, ge=18, lt=111),
    phone: str  = Query(default=None, pattern=r"^\d{11}$"),
):
    return {"name": name, "age": age, "phone": phone}
</code></pre>
<p>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–ª–∞—Å—Å–∞ Query –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∞—Ç—å —á–µ—Ä–µ–∑ —Å—Ç—Ä–æ–∫—É –∑–∞–ø—Ä–æ—Å–∞ —Å–ø–∏—Å–∫–∏. –í –æ–±—â–µ–º —Å–ª—É—á–∞–µ —Å–ø–∏—Å–∫–∏ –∑–Ω–∞—á–µ–Ω–∏–π –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è, –∫–æ–≥–¥–∞ –≤ —Å—Ç—Ä–æ–∫–µ –∑–∞–ø—Ä–æ—Å–∞ –æ–¥–Ω–æ–º—É –ø–∞—Ä–∞–º–µ—Ç—Ä—É –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —Ä–∞–∑–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è.</p>
<pre><code class="lang-py">@app.get("/users")
def users(params: list[str]  = Query()):   # GET /users/?params=1&#38;params=2&#38;params=3
    return {"params": params}              # {"params":["1","2","3"]}</code></pre>
<p>–ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–æ–∂–Ω–æ —Å–æ—á–µ—Ç–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—É—Ç–∏ –∏ —Å—Ç—Ä–æ–∫–∏ –∑–∞–ø—Ä–æ—Å–∞:</p>
<pre><code class="lang-py">@app.get("/users/{name}")
def users(
    name:str = Path(min_length=3, max_length=20), 
    age: int = Query(ge=18, lt=111),
):
    return {"name": name, "age": age}</code></pre>
<h3 class="section-title" id="status_codes">–°—Ç–∞—Ç—É—Å–Ω—ã–µ –∫–æ–¥—ã</h3>
<ul>
    <li>1xx: –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏. –û—Ç–≤–µ—Ç —Å —Ç–∞–∫–∏–º –∫–æ–¥–æ–º –Ω–µ –º–æ–∂–µ—Ç –∏–º–µ—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ</li>
    <li>2xx: —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —É—Å–ø–µ—à–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏</li>
    <li>3xx: –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã –¥–ª—è –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏–∏</li>
    <li>4xx: –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –æ—à–∏–±–æ–∫ –∫–ª–∏–µ–Ω—Ç–∞</li>
    <li>5xx: –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –æ—à–∏–±–∫–∞—Ö —Å–µ—Ä–≤–µ—Ä–∞</li>
</ul>
<p></p>
<pre><code class="lang-py"># –§—É–Ω–∫—Ü–∏—è –≤–Ω–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –¥–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞ –∏–ª–∏ —á–µ–≥–æ-—Ç–æ –¥—Ä—É–≥–æ–≥–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 404
@app.get("/not_found", status_code=404)
def not_found():
    return {"message": "Resource Not Found"}

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–Ω–æ–≥–æ –∫–æ–¥–∞ –≤ –æ—Ç–≤–µ—Ç–µ
@app.get("/not_found2")
def not_found2():
    return JSONResponse(content={"message": "Resource Not Found"}, status_code=404)

# –ú–æ–∂–Ω–æ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å –æ–±–∞ –ø–æ–¥—Ö–æ–¥–∞
@app.get("/users/{id}", status_code=200)
def users(response: Response, id: int = Path()):
    if id < 1:
        response.status_code = 400
        return {"message": "Incorrect Data"}
    return  {"message": f"Id = {id}"}</code></pre>
<h3 class="section-title" id="redirections">–ü–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏—è</h3>
<p>–î–ª—è –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ FastAPI –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–ª–∞—Å—Å RedirectResponse (–∫–ª–∞—Å—Å-–Ω–∞—Å–ª–µ–¥–Ω–∏–∫ –æ—Ç Response). –í –∫–∞—á–µ—Å—Ç–≤–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä RedirectResponse –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∞–¥—Ä–µ—Å –¥–ª—è –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è</p>
<pre><code class="lang-py">import mimetypes
from fastapi.responses import RedirectResponse, PlainTextResponse

@app.get("/old")
def old():
    return RedirectResponse("/new")

@app.get("/new")
def new():
    return PlainTextResponse("–ù–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞")

# –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç
@app.get("/old", response_class= RedirectResponse)
def old():
    return "/new"

# –¢–∞–∫–∂–µ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å –ø–æ –∞–±—Å–æ–ª—é—Ç–Ω–æ–º—É –∞–¥—Ä–µ—Å—É
@app.get("/old")
def old():
    return RedirectResponse("https://ya.ru")
</code></pre>
<h3 class="section-title" id="static_fiels">–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã</h3>
<p>–î–ª—è —Ä–∞–±–æ—Ç—ã —Å–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏ FastAPI –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —É–¥–æ–±–Ω—ã–π –∏ –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞—Å–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è –≤ –ø–∞–∫–µ—Ç–µ fastapi.staticfiles. –í —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, –¥–ª—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤ –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º –∫–∞—Ç–∞–ª–æ–≥–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–ª–∞—Å—Å StaticFiles</p>
<pre><code class="lang-py">StaticFiles(directory=None, packages=None, html=False, check_dir=True)</code></pre>
<ul>
    <li>directory: –ø—É—Ç—å –∫ –∫–∞—Ç–∞–ª–æ–≥—É —Å–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏</li>
    <li>packages: —Å–ø–∏—Å–æ–∫ –ø–∞–∫–µ—Ç–æ–≤ python –≤ –≤–∏–¥–µ —Å–ø–∏—Å–∫–∞ —Å—Ç—Ä–æ–∫ –∏–ª–∏ –∫–æ—Ä—Ç–µ–∂–µ–π —Å—Ç—Ä–æ–∫</li>
    <li>html: —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∑–∞–ø—É—Å–∫ –≤ HTML-—Ä–µ–∂–∏–º–µ, –∫–æ–≥–¥–∞ –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ –∫–æ—Ä–Ω—é –∫–∞—Ç–∞–ª–æ–≥–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Ñ–∞–π–ª index.html (–ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ —Ç–∞–∫–æ–≥–æ —Ñ–∞–π–ª–∞)</li>
    <li>check_dir: –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –∫–∞—Ç–∞–ª–æ–≥ —Å–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç</li>
</ul>
<p>–í —Ñ–∞–π–ª–µ main.py –¥–ª—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤ –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞ public (–∏–ª–∏ –ª—é–±–æ–≥–æ –¥—Ä—É–≥–æ–≥–æ) –æ–ø—Ä–µ–¥–µ–ª–∏–º –∫–æ–¥</p>
<pre><code class="lang-py">from fastapi.staticfiles import StaticFiles

app.mount("/static", StaticFiles(directory="public"))

# –î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã - –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∂–µ–º –ø—É—Ç—å –¥–æ —Ñ–∞–π–ª–∞, –≤—Å–µ —Ä–∞–≤–Ω–æ –≤–µ—Ä–Ω–µ—Ç –µ–≥–æ
app.mount("/static", StaticFiles(directory="public", html=True))

# –ü–æ–¥–æ–±–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –º–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏ –¥–ª—è –≤—Å–µ–≥–æ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
app.mount("/", StaticFiles(directory="public", html=True))</code></pre>
<p>–î–ª—è —Ä–∞–±–æ—Ç—ã —Å–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏ –≤–Ω–∞—á–∞–ª–µ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –∫–ª–∞—Å—Å StaticFiles. –ó–∞—Ç–µ–º —Å–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è FastAPI –∏ –≤—ã–∑—ã–≤–∞–µ–º —É –Ω–µ–≥–æ –º–µ—Ç–æ–¥ mount(). –ú–µ—Ç–æ–¥ mount() —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –æ–±—ä–µ–∫—Ç ASGIApp0 - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º—É –ø—É—Ç–∏. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ –ø—É—Ç–∏ "/static" –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ–±—Ä–∞–±–æ—Ç—á–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤—ã—Å—Ç—É–ø–∞–µ—Ç –æ–±—ä–µ–∫—Ç StaticFiles, –≤ –∫–æ—Ç–æ—Ä–æ–º —Å –ø–æ–º–æ—â—å—é –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ directory –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∫–∞—Ç–∞–ª–æ–≥–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∫–∞—Ç–∞–ª–æ–≥ "/public" (–Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–∞–ª–æ–≥–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ).</p>
<h3 class="section-title" id="get_req_data">–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞</h3>
<p>–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–ª–∞—Å—Å Body –∏–∑ –ø–∞–∫–µ—Ç–∞ fastapi. –î–∞–Ω–Ω—ã–π –∫–ª–∞—Å—Å –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–≤—è–∑–∞—Ç—å —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º —Ñ—É–Ω–∫—Ü–∏–∏-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –ª–∏–±–æ –≤—Å–µ —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞, –ª–∏–±–æ –∫–∞–∫–∏–µ-—Ç–æ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è.</p>
<pre><code class="lang-py">@app.post("/hello")
def hello(data = Body()):
    p1 = data["param1"]
    p2 = data["param2"]
    return {"message": f"p1 = {p1}, p2 = {p2}"}

# –£—Å—Ç–∞–Ω–æ–≤–∏–≤ –ø–∞—Ä–∞–º–µ—Ç—Ä embed=True, –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
@app.post("/hello")
def hello(name = Body(embed=True), age = Body(embed=True)):
    return {"message": f"{name}, –≤–∞—à –≤–æ–∑—Ä–∞—Å—Ç - {age}"}

# –†–∞—Å–ø—Ä–æ—Å—Ç–∞–Ω–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: min_length, max_length, pattern, lt, le, gt, ge

@app.post("/hello")
def hello(
    name: str = Body(embed=True, min_length=3, max_length=20), 
    age: int = Body(embed=True, ge=18, lt=111)
):
    return {"message": f"{name}, –≤–∞—à –≤–æ–∑—Ä–∞—Å—Ç - {age}"}</code></pre>
<p>FastAPI —Ç–∞–∫–∂–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –≤–∏–¥–µ –æ–±—ä–µ–∫—Ç–æ–≤ —Å–≤–æ–∏—Ö –∫–ª–∞—Å—Å–æ–≤. –¢–∞–∫–∏–µ –∫–ª–∞—Å—Å—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É–Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω—ã –æ—Ç –∫–ª–∞—Å—Å–∞ pydantic.BaseModel. –¢–∞–∫–∏–µ –∫–ª–∞—Å—Å—ã –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –ø–æ–¥ –∑–∞–ø—Ä–æ—Å, –¥–∞–Ω–Ω—ã–µ –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–ª—É—á–∏—Ç—å.</p>
<pre><code class="lang-py">from pydantic import BaseModel

class Person(BaseModel):
    name: str  # –µ—Å–ª–∏ –≤ –∑–∞–ø—Ä–æ—Å–µ –Ω–µ –±—É–¥–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è —Ö–æ—Ç—è –±—ã –¥–ª—è –æ–¥–Ω–æ–≥–æ –∏–∑ —ç—Ç–∏—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤
    age: int  # —Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–∏—à–ª–µ—Ç –∫–ª–∏–µ–Ω—Ç—É –æ—à–∏–±–∫—É

@app.post("/hello")
def hello(person: Person):
    return {"message": f"–ü—Ä–∏–≤–µ—Ç, {person.name}, —Ç–≤–æ–π –≤–æ–∑—Ä–∞—Å—Ç - {person.age}"}

# –û–¥–Ω–∞–∫–æ –º—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ–º —Å–¥–µ–ª–∞—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏

class Person(BaseModel):
    name: str
    age: int | None = None

@app.post("/hello")
def hello(person: Person):
    if person.age == None:
        return {"message": f"–ü—Ä–∏–≤–µ—Ç, {person.name}"}
    else:
        return {"message": f"–ü—Ä–∏–≤–µ—Ç, {person.name}, —Ç–≤–æ–π –≤–æ–∑—Ä–∞—Å—Ç - {person.age}"}

# –î–ª—è –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –º–æ–¥–µ–ª–∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–ª–∞—Å—Å pydantic.Field
# –ù–∞–ø—Ä–∏–º–µ—Ä, –æ–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–¥–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏ –ø—Ä–∞–≤–∏–ª–∞ –≤–∞–ª–¥–∞—Ü–∏–∏ –∑–Ω–∞—á–µ–Ω–∏–π
# —Å –ø–æ–º–æ—â—å—é –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞:

# –†–∞—Å–ø—Ä–æ—Å—Ç–∞–Ω–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: min_length, max_length, pattern, lt, le, gt, ge

class Person(BaseModel):
    name: str = Field(default="Undefined", min_length=3, max_length=20)
    age: int= Field(default=18, ge=18, lt=111)

# –ü–æ–¥–æ–±–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∞—Ç—å —Å–ø–∏—Å–æ–∫ –æ–±—ä–µ–∫—Ç–æ–≤ –º–æ–¥–µ–ª–∏

@app.post("/hello")
def hello(people: list[Person]):
    return {"message": people}

# –ü–æ–ª—É—á–µ–Ω–∏–µ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö —Å–ø–∏—Å–∫–æ–≤

class Person(BaseModel):
    name: str
    languages: list = []

@app.post("/hello")
def hello(person: Person):
    return {"message": f"Name: {person.name}. Languages: {person.languages}"}

# –í–ª–æ–∂–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏

class Company(BaseModel):
    name: str

class Person(BaseModel):
    name: str
    company: Company

@app.post("/hello")
def hello(person: Person):
    return {"message": f"{person.name} ({person.company.name})"}</code></pre>
<h3 class="section-title" id="get_send_headers">–û—Ç–ø—Ä–∞–≤–∫–∞ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤</h3>
<p>–î–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∫–ª–∞—Å—Å–∞ Response –∏–ª–∏ –µ–≥–æ –Ω–∞—Å–ª–µ–¥–Ω–∏–∫–æ–≤ –ø–∞—Ä–∞–º–µ—Ç—Ä—É headers –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è —Å–ª–æ–≤–∞—Ä—å, –≥–¥–µ –∫–ª—é—á–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç –Ω–∞–∑–≤–∞–Ω–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤. –¢–∞–∫–∂–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å —Å –ø–æ–º–æ—â—å—é –∞—Ç—Ä–∏–±—É—Ç–∞ headers, –∫–æ—Ç–æ—Ä—ã–π –µ—Å—Ç—å —É –∫–ª–∞—Å—Å–∞ Response –∏ –µ–≥–æ –Ω–∞—Å–ª–µ–¥–Ω–∏–∫–æ–≤. –î–∞–Ω–Ω—ã–π –∞—Ç—Ä–∏–±—É—Ç —Ç–∞–∫–∂–µ  —Å–ª–æ–≤–∞—Ä—å, –≥–¥–µ –∫–ª—é—á–∏ - –Ω–∞–∑–≤–∞–Ω–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤:</p>
<pre><code class="lang-py">from fastapi import Header

@app.get("/")
def root():
    data = "Hello FastAPI!"
    return Response(content=data, media_type="text/plain", headers={"Secret-Code" : "123459"})

@app.get("/")
def root(response: Response):
    response.headers["Secret-Code"] = "123459"
    return {"message": "Hello FastAPI!"}

# –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
# –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –∑–∞–ø—Ä–æ—Å–∞ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–ª–∞—Å—Å fastapi.Header

@app.get("/")
def root(user_agent: str = Header()):
    return {"User-Agent": user_agent}

# –í –∑–∞–ø—Ä–æ—Å–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –º–æ–∂–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å. –ú—ã –º–æ–∂–µ–º —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–ª—è –Ω–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

@app.get("/")
def root(secret_code: str | None = Header(default=None)):
    return {"Secret-Code": secret_code}</code></pre>
<h3 class="section-title" id="coockies">–ö—É–∫–∏</h3>
<p>–î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∫—É–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ —É –æ–±—ä–µ–∫—Ç–∞ Response –∏ –µ–≥–æ –∫–ª–∞—Å—Å–æ–≤-–Ω–∞—Å–ª–µ–¥–Ω–∏–∫–æ–≤ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –º–µ—Ç–æ–¥ set_cookie(). –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ä—è–¥ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:</p>
<ul>
    <li>key: –∫–ª—é—á –∏–ª–∏ –∏–º—è –∫—É–∫–∏. –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä</li>
    <li>value: –∑–Ω–∞—á–µ–Ω–∏–µ –∫—É–∫–∏, –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é - –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞</li>
    <li>max_age: –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ –∫—É–∫–∏ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö. –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ª–∏–±–æ —á–∏—Å–ª–æ, –ª–∏–±–æ –∑–Ω–∞—á–µ–Ω–∏–µ None (–æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ –∫—É–∫–∏ —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–µ–π –±—Ä–∞—É–∑–µ—Ä–∞, —è–≤–ª—è–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é).</li>
    <li>expires: –∫–æ–≥–¥–∞ –∏—Å—Ç–µ–∫–∞–µ—Ç –¥–µ–π—Å—Ç–≤–∏–µ –∫—É–∫–∏. –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ª–∏–±–æ —á–∏—Å–ª–æ, –ª–∏–±–æ –∑–Ω–∞—á–µ–Ω–∏–µ None (–æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ –∫—É–∫–∏ —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–µ–π –±—Ä–∞—É–∑–µ—Ä–∞, —è–≤–ª—è–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é).</li>
    <li>path: –ø—É—Ç—å, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–≥–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –∫—É–∫–∏. –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é - –∫–æ—Ä–µ–Ω—å –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è "/"</li>
    <li>domain: –¥–æ–º–µ–Ω, –∫ –∫–æ—Ç–æ—Ä–æ–º—É –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫—É–∫–∏. –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é None</li>
    <li>secure: —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª. –¢–∞–∫, –µ—Å–ª–∏ –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ True, —Ç–æ –∫—É–∫–∏ –±—É–¥—É—Ç –ø–æ—Å—ã–ª–∞—Ç—å—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä —Ç–æ–ª—å–∫–æ –≤ –∑–∞–ø—Ä–æ—Å–µ –ø–æ –ø—Ä–æ—Ç–æ–∫–æ–ª—É https. –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é False</li>
    <li>httponly: —É—Å—Ç–∞–Ω–∞–≤–ª–∏–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –¥–ª—è —Å–∫—Ä–∏–ø—Ç–æ–≤ javascript –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ. –¢–∞–∫, –∑–Ω–∞—á–µ–Ω–∏–µ True –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –∫—É–∫–∏ –∏–∑ –∫–æ–¥–∞ javascript –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ. –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é False</li>
    <li>samesite: —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É –∫—É–∫–∏ –≤ –∫—Ä–æ—Å—Å–¥–æ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö. –¢–∞–∫, –∑–Ω–∞—á–µ–Ω–∏–µ lax (–∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) —É–∫–∞–∑—ã–≤–∞—é—Ç –±—Ä–∞—É–∑–µ—Ä—É –Ω–µ –ø–æ—Å—ã–ª–∞—Ç—å –∫—É–∫–∏ –≤ –∫—Ä–æ—Å—Å–¥–æ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö.</li>
</ul>
<pre><code class="lang-py">from fastapi import FastAPI, Cookie
from datetime import datetime

@app.get("/")
def root(response: Response):
    now = datetime.now()
    response.set_cookie(key="last_visit", value=now)
    return {"message": "–∫—É–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã"}

@app.get("/")
def root():
    now = datetime.now()
    response = JSONResponse(content={"message": "–∫—É–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã"})
    response.set_cookie(key="last_visit", value=now)
    return response

# –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫—É–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–ª–∞—Å—Å fastapi.Cookie

@app.get("/")
def root(last_visit = Cookie()):
    return  {"last visit": last_visit}

@app.get("/")
def root(last_visit: str | None = Cookie(default=None)):
    if last_visit == None:
        return {"message": "–≠—Ç–æ –≤–∞—à –ø–µ—Ä–≤—ã–π –≤–∏–∑–∏—Ç –Ω–∞ —Å–∞–π—Ç"}
    else:
        return  {"message": f"–í–∞—à –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤–∏–∑–∏—Ç: {last_visit}"}</code></pre>
<h3 class="section-title" id="forms">–§–æ—Ä–º—ã</h3>
<p>–†–∞–±–æ—Ç–∞ —Å —Ñ–æ—Ä–º–∞–º–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞. –ü—Ä–µ–∂–¥–µ –≤—Å–µ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–æ–¥—É–ª—å python-multipart</p>
<pre><code class="lang-bash">pip install python-multipart</code></pre>
<pre><code class="lang-py">@app.post("/postdata")
# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è —Ç–∞–∫–∂–µ, –∫–∞–∫ –∏ –∞—Ç—Ä–∏–±—É—Ç—ã —É –ø–æ–ª–µ–π —Ñ–æ—Ä–º—ã, —Å –∫–æ—Ç–æ—Ä–æ–π –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º
def postdata(username=Form(), userage=Form()):
    return {"name": username, "age": userage}

# –†–∞—Å–ø—Ä–æ—Å—Ç–∞–Ω–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: min_length, max_length, pattern, lt, le, gt, ge

@app.post("/postdata")
def postdata(
    username: str = Form(min_length=2, max_length=20), 
    userage: int =Form(ge=18, lt=111)
):
    return {"name": username, "age": userage}

# –° –ø–æ–º–æ—â—å—é –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ default –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ Form –º–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

@app.post("/postdata")
def postdata(
    username: str = Form(default ="Undefined", min_length=2, max_length=20), 
    userage: int =Form(default=18, ge=18, lt=111),
):
    return {"name": username, "age": userage}

# –° –ø–æ–º–æ—â—å—é —Ñ–æ—Ä–º –º–æ–≥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –Ω–∞–±–æ—Ä—ã –¥–∞–Ω–Ω—ã—Ö

@app.post("/postdata")
def postdata(
    username: str = Form(), 
    languages: list =Form()
):
    return {"name": username, "languages": languages}</code></pre>
<h3 class="section-title" id="make_simple_api">–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç–µ–π—à–µ–≥–æ API</h3>
<p>–†–µ–∞–ª–∏–∑—É–µ–º –ø—Ä–æ—Å—Ç–µ–π—à–µ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Web API –≤ —Å—Ç–∏–ª–µ REST. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ REST –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å–ª–µ–¥—É—é—â–∏—Ö –º–µ—Ç–æ–¥–æ–≤ –∏–ª–∏ —Ç–∏–ø–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤ HTTP –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º, –≥–¥–µ –∫–∞–∂–¥—ã–π —Ç–∏–ø –∑–∞–ø—Ä–æ—Å–∞ –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ: GET (–ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö), POST (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö), PUT (–∏–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö), DELETE (—É–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö).</p>
<pre><code class="lang-py">import uuid
from fastapi import FastAPI, Body, status
from fastapi.responses import JSONResponse, FileResponse

class Person:
    def __init__(self, name, age):
        self.name = name
        self.age = age
        self.id = str(uuid.uuid4())

# –£—Å–ª–æ–≤–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö - –Ω–∞–±–æ—Ä –æ–±—ä–µ–∫—Ç–æ–≤ Person
people = [Person("Alyx", 11), Person("John", 12), Person("Nik", 13)]

def find_person(id):
    """–§—É–Ω–∫—Ü–∏—è –∏—â–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–ø–∏—Å–∫–µ –ø–æ –∞–π–¥–∏."""
    for person in people: 
        if person.id == id:
            return person
    return None

app = FastAPI()

@app.get("/")
async def main():
    return FileResponse("public/index.html")

@app.get("/api/users")  # –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
def get_users():
    return people

@app.get("/api/users/{id}")  # –î–µ—Ç–∞–ª—å–Ω—ã–π –≤–∏–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —é–∑–µ—Ä–∞
def get_user_detail(id):
    person = find_person(id)
    print(person)
    if person == None:  
        return JSONResponse(
            status_code=status.HTTP_404_NOT_FOUND, 
            content={ "message": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω" }
        )
    return person

@app.post("/api/users")  # –°–æ–∑–¥–∞–Ω–∏–µ —é–∑–µ—Ä–∞
def create_user(data = Body()):
    person = Person(data["name"], data["age"])
    people.append(person)
    return person

@app.put("/api/users")  # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —é–∑–µ—Ä–∞
def edit_user(data = Body()):
    person = find_person(data["id"])
    if person == None: 
        return JSONResponse(
            status_code=status.HTTP_404_NOT_FOUND, 
            content={ "message": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω" }
        )
    person.age = data["age"]
    person.name = data["name"]
    return person

@app.delete("/api/users/{id}")  # –£–¥–∞–ª–µ–Ω–∏–µ —é–∑–µ—Ä–∞
def delete_user(id):
    person = find_person(id)
    if person == None:
        return JSONResponse(
            status_code=status.HTTP_404_NOT_FOUND, 
            content={ "message": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω" }
        )
    people.remove(person)
    return person
</code></pre>
<h3 class="section-title" id="sqlalchemy">–†–∞–±–æ—Ç–∞ —Å –ë–î —á–µ—Ä–µ–∑ SQLAlchemy</h3>
<p>FastAPI –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–∞–±–æ—Ç—É —Å —Å–∞–º—ã–º–∏ —Ä–∞–∑–Ω—ã–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö: PostgreSQL, MySQL, SQLite, Oracle, Microsoft SQL Server –∏ —Ç.–¥. –ü—Ä–∏—á–µ–º –º—ã –Ω–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã —Ç–æ–ª—å–∫–æ —Ä–µ–∞–ª–∏—Ü–∏–æ–Ω–Ω—ã–º–∏ –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö –∏ —Ä–∞–≤–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏ –Ω–µ—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–µ, —Ç–∞–∫ –Ω–∞–∑—ã–≤–∞–µ–º—ã–µ NoSQL-—Å–∏—Å—Ç–µ–º—ã –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö.</p>
<p>–ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö —Å–∞–º—ã–º –ø—Ä–æ—Å—Ç—ã–º —Ä–µ—à–µ–Ω–∏–µ–º —è–≤–ª—è–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ - ORM (Object Relational Mapper), –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∑–≤–æ–ª—è—é—Ç –∞–±—Å—Ç—Ä–∞–≥–∏—Ä–æ–≤–∞—Ç—å—Å—è –æ—Ç —Å—Ç—Ä–æ–µ–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –°–£–ë–î –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≤—è–∑–∞—Ç—å —Å—É—â–Ω–æ—Å—Ç–∏ –≤ –∫–æ–¥–µ Python —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö. –í FastAPI –Ω–∞–∏–±–æ–ª–µ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–Ω—ã–º ORM-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º —è–≤–ª—è–µ—Ç—Å—è SQLAlchemy ORM. –†–∞—Å—Å–º–æ—Ç—Ä–∏–º —Ä–∞–±–æ—Ç—É —Å –ë–î —á–µ—Ä–µ–∑ SQLAlchemy ORM –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ SQLite.</p>
<p>–£—Å—Ç–∞–Ω–æ–≤–∏–º</p>
<pre><code class="lang-bash">pip install sqlalchemy</code></pre>
<p>–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ —Ç–∞–±–ª–∏—Ü –ø–æ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º –º–æ–¥–µ–ª–µ–π –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –º–µ—Ç–æ–¥ Base.metadata.create_all(). –ï–≥–æ –∫–ª—é—á–µ–≤–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä - bind –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∫–ª–∞—Å—Å, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö. –í –∫–∞—á–µ—Å—Ç–≤–µ —Ç–∞–∫–æ–≥–æ –∫–ª–∞—Å—Å–∞ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Ä–∞–Ω–µ–µ –¥–≤–∏–∂–æ–∫ SQLAlchemy. –ï—Å–ª–∏ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–∞–±–ª–∏—Ü—ã —É–∂–µ –∏–º–µ—é—Ç—Å—è, —Ç–æ –º–µ—Ç–æ–¥ –Ω–µ —Å–æ–∑–¥–∞–µ—Ç –∑–∞–Ω–æ–≤–æ —Ç–∞–±–ª–∏—Ü—ã.</p>
<pre><code class="lang-py">from sqlalchemy import create_engine, Column, Integer, String
from sqlalchemy.orm import DeclarativeBase
from fastapi import FastAPI

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
SQLALCHEMY_DATABASE_URL = "sqlite:///./sql_app.db"
# sqlite:///–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π_–ø—É—Ç—å/file.db
# sqlite:////–∞–±—Å–æ–ª—é—Ç–Ω—ã–π_–ø—É—Ç—å/file.db
# –ù–∞–ø—Ä–∏–º–µ—Ä –¥–ª—è PostgreSQL
# SQLALCHEMY_DATABASE_URL = "postgresql://user:password@postgresserver/db"

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–≤–∏–∂–∫–∞
engine = create_engine(
    SQLALCHEMY_DATABASE_URL,
    connect_args={
        # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é SQLite —Ä–∞–∑—Ä–µ—à–∞–µ—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å –ë–î —Ç–æ–ª—å–∫–æ
        # –æ–¥–Ω–æ–º—É –ø–æ—Ç–æ–∫—É. –≠—Ç–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —á—Ç–æ–±—ã –∏—Å–ø—Ä–∞–≤–∏—Ç—å —ç—Ç–æ
        "check_same_thread": False,
    }
)
# –ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –¥—Ä—É–≥–∏–º–∏ –°–£–ë–î –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É–∫–∞–∑–∞—Ç—å —Ç–æ–ª—å–∫–æ –∞–¥—Ä–µ—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:
# engine = create_engine(SQLALCHEMY_DATABASE_URL)

# –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –º–æ–¥–µ–ª–µ–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ –±–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å, –æ—Ç –∫–æ—Ç–æ—Ä–æ–π –ø–æ—Ç–æ–º –Ω–∞—Å–ª–µ–¥—É—é—Ç—Å—è –æ—Å—Ç–∞–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏
class Base(DeclarativeBase): pass

# –ó–∞—Ç–µ–º —É–∂–µ –º–æ–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –º–æ–¥–µ–ª–∏, –¥–∞–Ω–Ω—ã–µ –∫–æ—Ç–æ—Ä—ã—Ö –±—É–¥—É—Ç —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –≤ –ë–î
class Person(Base):
    __tablename__ = "people"
    id = Column(Integer, primary_key=True, index=True)
    name = Column(String)
    age = Column(Integer,)

# –°–±—Ä–æ—Å–∏—Ç—å —Ç–∞–±–ª–∏—Ü—ã
Base.metadata.create_all(bind=engine)

# –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç
app = FastAPI()</code></pre>
<p>–î–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –ë–î –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å —Å–µ—Å—Å–∏—é –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –æ–±—ä–µ–∫—Ç sqlalchemy.orm.Session. –ß–µ—Ä–µ–∑ —ç—Ç–æ—Ç –æ–±—ä–µ–∫—Ç –∏–¥–µ—Ç –≤—Å—è —Ä–∞–±–æ—Ç–∞ —Å –ë–î. –ù–æ –¥–ª—è —ç—Ç–æ–≥–æ –≤–Ω–∞—á–∞–ª–µ –Ω–∞–¥–æ —Å–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å-–ø–æ—Å—Ç—Ä–æ–∏—Ç–µ–ª—å Session —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏-—Ñ–∞–±—Ä–∏–∫–∏ sessionmaker().</p>
<pre><code class="lang-py">from sqlalchemy.orm import sessionmaker

# autoflush: –ø—Ä–∏ –∑–Ω–∞—á–µ–Ω–∏–∏ True (–¥–µ—Ñ–æ–ª—Ç) –±—É–¥–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è –º–µ—Ç–æ–¥ Session.flush()
#            –∫–æ—Ç–æ—Ä—ã–π –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
# bind: –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç —Å–µ—Å—Å–∏—é –±–¥ –∫ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º—É –¥–≤–∏–∂–∫—É,
#       –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
SessionLocal = sessionmaker(autoflush=False, bind=engine)
db = SessionLocal()
</code></pre>
<p>–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö - –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –ë–î –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞—Ç—å –æ–±—ä–µ–∫—Ç –º–æ–¥–µ–ª–∏, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ –º–µ—Ç–æ–¥ add() –æ–±—ä–µ–∫—Ç–∞ Session. –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π —É –æ–±—ä–µ–∫—Ç–∞ Session –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –º–µ—Ç–æ–¥ commit().</p>
<p>–°–ª–µ–¥—É–µ—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞, –µ—Å–ª–∏ –º—ã —Ö–æ—Ç–∏–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç –æ–±—ä–µ–∫—Ç, –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –µ–≥–æ –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏, —Ç–æ –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ, –∞ –∏–Ω–æ–≥–¥–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥ refresh(), –∫–æ—Ç–æ—Ä—ã–π –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞.</p>
<p>–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –∏–∑ –ë–î –≤–Ω–∞—á–∞–ª–µ —É –æ–±—ä–µ–∫—Ç–∞ Session –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–∑—ã–≤–∞—Ç—å –º–µ—Ç–æ–¥ query() - –≤ –Ω–µ–≥–æ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è —Ç–∏–ø –º–æ–¥–µ–ª–∏, –¥–∞–Ω–Ω—ã–µ –∫–æ—Ç–æ—Ä–æ–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–ª—É—á–∏—Ç—å. –ù–æ –¥–∞–Ω–Ω—ã–π –º–µ—Ç–æ–¥ –ø—Ä–æ—Å—Ç–æ —Å–æ–∑–¥–∞–µ—Ç –æ–±—ä–µ–∫—Ç Query - –Ω–µ–∫–æ—Ç–æ—Ä—ã–π –∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω –≤ –±—É–¥—É—â–µ–º –ø—Ä–∏ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ–º –ø–æ–ª—É—á–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö. –î–∞–ª–µ–µ –ø—Ä–∏–º–µ–Ω—è—è –∫ –æ–±—ä–µ–∫—Ç—É Query —Ä–∞–∑–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã, –º—ã –º–æ–∂–µ–º –ø–æ–ª—É—á–∏—Ç—å –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –Ω–∞–¥–æ –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ –æ–±—ä–µ–∫—Ç—ã, –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –º–µ—Ç–æ–¥ all(). –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –ø–æ id –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –º–µ—Ç–æ–¥ get(). –î–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —É –æ–±—ä–µ–∫—Ç–∞ Query –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –º–µ—Ç–æ–¥ filter(), –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —É—Å–ª–æ–≤–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏. –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –º–µ—Ç–æ–¥ first().</p>
<p>–î–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –µ–≥–æ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –∏ –∑–∞—Ç–µ–º –≤—ã–∑–≤–∞—Ç—å —É –æ–±—ä–µ–∫—Ç–∞ Session –º–µ—Ç–æ–¥ commit() –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π.</p>
<p>–î–ª—è —É–¥–∞–ª–µ–Ω–∏—è —É –æ–±—ä–µ–∫—Ç–∞ Session –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –º–µ—Ç–æ–¥ delete(), –≤ –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è —É–¥–∞–ª—è–µ–º—ã–π –æ–±—ä–µ–∫—Ç.</p>
<pre><code class="lang-py"># –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

alyx = Person(name='Alyx', age=19)
db.add(alyx)
db.commit()

# –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç Person –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –ë–î
tom = Person(name="Tom", age=38)
db.add(tom)      # –¥–æ–±–∞–≤–ª—è–µ–º –≤ –±–¥
db.commit()      # —Å–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
db.refresh(tom)  # –æ–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞
print(tom.id)    # –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π id

alice = Person(name="Alice", age=33)
kate = Person(name="Kate", age=28)
db.add_all([alice, kate])
db.commit()

# –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

# –í—Å–µ –æ–±—ä–µ–∫—Ç—ã
people = db.query(Person).all()
for p in people:
    print(f"{p.id}.{p.name} ({p.age})")

# –ú–µ—Ç–æ–¥—ã get() –∏ first() –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç None, –µ—Å–ª–∏ –æ–±—ä–µ–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω, –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å

# –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –Ω—É–∂–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞
first_person = db.get(Person, 1)
print(f"{first_person.name} - {first_person.age}")

# –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è
people = db.query(Person).filter(Person.age > 30).all()
for p in people:
    print(f"{p.id}.{p.name} ({p.age})")

# –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞
first = db.query(Person).filter(Person.id==1).first()
print(f"{first.name} ({first.age})")

# –î–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –µ–≥–æ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –∏ –≤—ã–∑–≤–∞—Ç—å commit()
tom.name = "Tomas"
tom.age = 22
db.commit()

# –î–ª—è —É–¥–∞–ª–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –º–µ—Ç–æ–¥ delete(), –≤ –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è —É–¥–∞–ª—è–µ–º—ã–π –æ–±—ä–µ–∫—Ç
bob = db.query(Person).filter(Person.id==2).first()
db.delete(bob)
db.commit()</code></pre>
<h3 class="section-title" id="base_ops_db">–ë–∞–∑–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –≤ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏</h3>
<p>–í—ã–Ω–µ—Å—Ç–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π database.py –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ë–î</p>
<pre><code class="lang-py">from sqlalchemy import create_engine
from sqlalchemy.orm import DeclarativeBase
from sqlalchemy.orm import sessionmaker
from sqlalchemy import  Column, Integer, String

SQLALCHEMY_DATABASE_URL = "sqlite:///./sqlite.db"
engine = create_engine(SQLALCHEMY_DATABASE_URL, connect_args={"check_same_thread": False})

class Base(DeclarativeBase): pass

class Person(Base):
    __tablename__ = "people"
    id = Column(Integer, primary_key=True, index=True)
    name = Column(String)
    age = Column(Integer,)

SessionLocal = sessionmaker(autoflush=False, bind=engine)</code></pre>
<p>–°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞</p>
<pre><code class="lang-py">from database import Base, Person, SessionLocal, engine
from sqlalchemy.orm import Session
from fastapi import Depends, FastAPI, Body
from fastapi.responses import JSONResponse, FileResponse

Base.metadata.create_all(bind=engine)
app = FastAPI()

def get_db():
    db = SessionLocal()
    try:
        yield db
    finally:
        db.close()

@app.get("/")
def main():
    return FileResponse("public/index.html")

@app.get("/api/users")
def get_people(db: Session = Depends(get_db)):
    return db.query(Person).all()

@app.get("/api/users/{id}")
def get_person(id, db: Session = Depends(get_db)):
    person = db.query(Person).filter(Person.id == id).first()
    if person == None:  
        return JSONResponse(status_code=404, content={"message": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω"})
    return person

@app.post("/api/users")
def create_person(data  = Body(), db: Session = Depends(get_db)):
    person = Person(name=data["name"], age=data["age"])
    db.add(person)
    db.commit()
    db.refresh(person)
    return person

@app.put("/api/users")
def edit_person(data  = Body(), db: Session = Depends(get_db)):
    person = db.query(Person).filter(Person.id == data["id"]).first()
    if person == None: 
        return JSONResponse(status_code=404, content={ "message": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω"})
    person.age = data["age"]
    person.name = data["name"]
    db.commit()
    db.refresh(person)
    return person

@app.delete("/api/users/{id}")
def delete_person(id, db: Session = Depends(get_db)):
    person = db.query(Person).filter(Person.id == id).first()
    if person == None:
        return JSONResponse(status_code=404, content={ "message": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω"})
    db.delete(person)
    db.commit()
    return person</code></pre>
